<!-- শুধু Script অংশ Replace করুন বা Add করুন নিচের মত -->

<script>
  function loadStudentDashboard() {
    const withdrawalTable = document.getElementById("withdrawalTableBody");
    withdrawalTable.innerHTML = "";

    const requests = JSON.parse(localStorage.getItem("withdrawalRequests")) || [];

    if (requests.length === 0) {
      withdrawalTable.innerHTML = `<tr><td colspan="4">No withdrawal requests found.</td></tr>`;
      return;
    }

    requests.forEach((req, index) => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${req.studentId}</td>
        <td>${req.amount}</td>
        <td>${req.status}</td>
        <td>${req.date}</td>
        <td>
          ${req.status === "Pending" ? `
            <button onclick="approveRequest(${index})">Approve</button>
            <button onclick="rejectRequest(${index})">Reject</button>
          ` : ""}
        </td>
      `;
      withdrawalTable.appendChild(row);
    });
  }

  function approveRequest(index) {
    const requests = JSON.parse(localStorage.getItem("withdrawalRequests")) || [];
    const passbook = JSON.parse(localStorage.getItem("passbookRecords")) || [];

    const req = requests[index];
    req.status = "Approved";

    // Passbook Entry for Withdrawal
    passbook.push({
      studentId: req.studentId,
      description: "Withdrawal Approved",
      amount: `-${req.amount}`,
      date: new Date().toLocaleString("bn-BD")
    });

    localStorage.setItem("withdrawalRequests", JSON.stringify(requests));
    localStorage.setItem("passbookRecords", JSON.stringify(passbook));
    loadStudentDashboard();
  }

  function rejectRequest(index) {
    const requests = JSON.parse(localStorage.getItem("withdrawalRequests")) || [];
    requests[index].status = "Rejected";
    localStorage.setItem("withdrawalRequests", JSON.stringify(requests));
    loadStudentDashboard();
  }

  window.onload = loadStudentDashboard;
</script>